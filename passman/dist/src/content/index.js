import{b as r}from"../../assets/browser-polyfill.IGg3PfuX.js";console.log("PassMan content script loaded");function i(){const t=document.querySelectorAll('input[type="password"]');return t.length===0?null:Array.from(t).find(o=>o.offsetParent!==null)||t[0]}function u(t){const o=t.form;if(o){const n=Array.from(o.querySelectorAll('input:not([type="hidden"]):not([type="submit"]):not([type="button"])')),s=n.indexOf(t);if(s>0)return n[s-1]}let e=t.previousElementSibling;for(;e;){if(e instanceof HTMLInputElement&&(e.type==="text"||e.type==="email"))return e;e=e.previousElementSibling}return null}r.runtime.onMessage.addListener(t=>{if(t.type==="FILL_LOGIN"){const{username:o,password:e}=t.payload,n=i();if(n){n.value=e,n.dispatchEvent(new Event("input",{bubbles:!0})),n.dispatchEvent(new Event("change",{bubbles:!0}));const s=u(n);s&&(s.value=o,s.dispatchEvent(new Event("input",{bubbles:!0})),s.dispatchEvent(new Event("change",{bubbles:!0}))),console.log("PassMan: Auto-filled credentials")}else console.warn("PassMan: No password field found to fill")}});document.addEventListener("submit",t=>{const e=t.target.querySelector('input[type="password"]');if(!e||!e.value)return;const n=u(e);if(!n||!n.value)return;const s={type:"CAPTURE_LOGIN",payload:{username:n.value,password:e.value,url:window.location.href,siteName:window.location.hostname}};r.runtime.sendMessage(s).catch(a=>{console.log("PassMan capture sent",a)})},!0);
